---
title: "Useful RDKit Utils - A Mötley Collection of Helpful Routines"
date: 2025-05-12
tags:
  - Cheminformatics
---
![][image1]  
A few years ago, I assembled an open-source collection of Python functions and classes that I use regularly. My motivations for putting this together were primarily selfish; I wanted to quickly pip install the functions I use all the time. The result was [useful\_rdkit\_utils](https://github.com/PatWalters/useful_rdkit_utils), a library of Cheminformatics and machine learning (ML) functions. The library is available [on GitHub](https://github.com/PatWalters/useful_rdkit_utils), and the documentation can be found on [readthedocs](https://useful-rdkit-utils.readthedocs.io/en/latest/). The GitHub repo also includes a set of [Jupyter notebooks](https://github.com/PatWalters/useful_rdkit_utils/tree/master/notebooks) that demonstrate some of the library's capabilities. I recently refactored the code and added new functionality, so I thought it might be worth writing a blog post to reintroduce the library. Here is a brief overview of the useful\_rdkit\_utils library.  

**REOS** \- I've previously written about [functional group filters](https://practicalcheminformatics.blogspot.com/2018/08/filtering-chemical-libraries.html) and their importance in removing objectionable functionality from screening collections or combinatorial libraries.  The [REOS](https://www.sciencedirect.com/science/article/pii/S1367593199800581) class in useful\_rdkit\_utils provides easy programmatic access to the sets of functional group filters available in the [ChEMBL](https://www.ebi.ac.uk/chembl/) database.   The REOS class can be instantiated with one or more functional group rule sets and can filter RDKit molecules or SMILES.  The new version can also return the results as a [Pandas](https://pandas.pydata.org/) dataframe. 

**Ring Systems** \- The useful\_rdkit\_utils library has two classes that provide functionality for working with [ring systems](https://practicalcheminformatics.blogspot.com/2022/12/identifying-ring-systems-in-molecules.html).  The [RingSystemFinder](https://useful-rdkit-utils.readthedocs.io/en/latest/ring_systems.html#useful_rdkit_utils.ring_systems.RingSystemFinder) class identifies ring systems and makes it easy to perform analyses like those in [Peter Ertl's papers](https://pubs.acs.org/doi/10.1021/jm060217p).  The most helpful class is [RingSystemLookup](https://useful-rdkit-utils.readthedocs.io/en/latest/ring_systems.html#useful_rdkit_utils.ring_systems.RingSystemLookup), which I use to filter the output of generative models.   Many of these models tend to produce silly molecules that could never exist.   These silly molecules often contained unstable or strained ring systems.  One quick way to check whether a ring system is viable is to see if it exists in the literature.  To this end, I analyzed the [ChEBML database](https://www.ebi.ac.uk/chembl/) and extracted all the ring systems and their frequencies.   When presented with a molecule, the RingSystemLookup class returns a list of ring systems and their associated frequencies.  In practice, I typically reject any generated molecule containing a ring system that appears fewer than five times in ChEMBL.   The useful\_rdkit\_utils library also contains a few utility functions that make it easier to identify [spiro fusions](https://useful-rdkit-utils.readthedocs.io/en/latest/ring_systems.html#useful_rdkit_utils.ring_systems.get_spiro_atoms) and get information on the [ring sizes](https://useful-rdkit-utils.readthedocs.io/en/latest/ring_systems.html#useful_rdkit_utils.ring_systems.max_ring_size) in a molecule. 

**Fingerprints and Descriptors**—The Morgan (aka [ECFP](https://pubs.acs.org/doi/10.1021/ci100050t)) fingerprints and descriptors in the RDKit have become de facto standards for machine learning (ML) with molecules. I have written a few functions and classes that make accessing these descriptors and using them with ML models easier. All of these classes include a progress bar. 

* [**Smi2Fp**](https://useful-rdkit-utils.readthedocs.io/en/latest/descriptors.html#useful_rdkit_utils.descriptors.Smi2Fp) generates fingerprints from SMILES. The fingerprints can be binary or counts, and the function returns the fingerprint as either an ExplicitBitVect or a numpy array.  
* [**RDKitDescriptors**](https://useful-rdkit-utils.readthedocs.io/en/latest/descriptors.html#useful_rdkit_utils.descriptors.RDKitDescriptors) generates 1D descriptors from SMILES or RDKit molecules and can return results as a Pandas dataframe.  
* [**Ro5Calculator**](https://useful-rdkit-utils.readthedocs.io/en/latest/descriptors.html#useful_rdkit_utils.descriptors.Ro5Calculator) generates descriptors for Lipinski’s Rule of 5, including TPSA, from SMILES or RDKit molecules, and can return results as a Pandas dataframe.

Those interested in using RDKit with ML models may also want to check out these libraries, which provide complete workflows for ML with molecules:   
Scikit-Mol \- [paper](https://chemrxiv.org/engage/api-gateway/chemrxiv/assets/orp/resource/item/60ef0fc58825826143a82cc0/original/scikit-mol-brings-cheminformatics-to-scikit-learn.pdf), [code](https://github.com/EBjerrum/scikit-mol)  
MolPipeline \- [paper](https://chemrxiv.org/engage/chemrxiv/article-details/661fec7f418a5379b00ae036), [code](https://github.com/basf/MolPipeline/tree/main)  
datamol \- [docs](https://docs.datamol.io/stable/), [code](https://github.com/datamol-io/datamol)

**Conformers and Molecular Geometry** \- I'm constantly looking up how to generate conformers with the RDKit.  To make my life easier, I wrote [a function](https://useful-rdkit-utils.readthedocs.io/en/latest/geometry.html#useful_rdkit_utils.geometry.gen_conformers) to encapsulate this capability.  The library also has utility functions to [calculate a molecule's center](https://useful-rdkit-utils.readthedocs.io/en/latest/geometry.html#useful_rdkit_utils.geometry.get_center) and [principal moments of inertia](https://useful-rdkit-utils.readthedocs.io/en/latest/geometry.html#useful_rdkit_utils.geometry.get_shape_moments).  These functions simply alias existing functionality in the RDKit. 

**Jupyter Notebooks**—Most of my work is in Jupyter Notebooks. I often forget the RDKit commands to turn on SVG for images, use CoordGen to improve structure quality, or set the structure image size. To make this easier, I wrote a set of [utility functions starting with "rd\_."](https://useful-rdkit-utils.readthedocs.io/en/latest/jupyter.html)   To access these functions, I'll typically put the statement "import useful\_rdkit\_utils as uru" at the top of the notebook.  Then, if I want to customize the notebook, I can type "uru.rd\_", followed by \<tab\>, and I'll get a list of customization functions with intuitive names.  Most of my notebooks include the function rd\_setup\_jupyter, which sets my preferred defaults with a single command. 

**Statistics** \- I added a few statistical functions that I frequently use.   
[Bootstrap a confidence interval](https://useful-rdkit-utils.readthedocs.io/en/latest/stats.html#useful_rdkit_utils.stat_utils.bootstrap_confidence_interval). When calculating performance statistics for an ML model, one should always calculate a confidence interval around that metric.   
[Confidence interval for a Pearson correlation coefficient](https://useful-rdkit-utils.readthedocs.io/en/latest/stats.html#useful_rdkit_utils.stat_utils.pearson_confidence) \- The confidence interval around Pearson's r depends on the r value and the number of data points. This function calculates the confidence interval.   
[Maximum possible correlation](https://useful-rdkit-utils.readthedocs.io/en/latest/stats.html#useful_rdkit_utils.stat_utils.max_possible_correlation) \- When building a model, the underlying data can be used to estimate the maximum possible correlation given experimental error. I wrote more about this here.   
   
**Cross-Validation and Data Splitting** \- At the end of last year, several of us wrote a [preprint](https://chemrxiv.org/engage/chemrxiv/article-details/672a91bd7be152b1d01a926b) outlining a set of recommendations for the statistical validation of machine learning models in drug discovery. This subset of useful\_rdkit\_utils [provides an implementation](https://useful-rdkit-utils.readthedocs.io/en/latest/split_utils.html) of some methods described in that preprint. 

**Seaborn** \-  The library has [a few functions](https://useful-rdkit-utils.readthedocs.io/en/latest/seaborn.html) to set the defaults I like. 

**Pandas** \- A couple of [quick utility functions](https://useful-rdkit-utils.readthedocs.io/en/latest/pandas.html) to send the output of value\_counts to a dataframe and to capture RDKit molecule parsing errors in a dataframe column. 

**Units**—[Two small functions](https://useful-rdkit-utils.readthedocs.io/en/latest/units.html) that interconvert between kcal/mol and binding affinity units (uM, nM, etc.).  I find these essential when working with free energy calculations. 

**Acknowledgments** \- Some functions in this library have been borrowed or adapted from other open-source collections. I would particularly like to thank [iwatobipen](https://iwatobipen.wordpress.com/), whose blog is a constant source of inspiration. I also owe a huge debt to Greg Landrum, Brian Kelley, Paolo Tosco, and the other RDKit developers, without whom none of this would be possible. 
